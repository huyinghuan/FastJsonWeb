//     uuid.js
//
//     (c) 2010-2012 Robert Kieffer
//     MIT License
//     https://github.com/broofa/node-uuid
//本算法采用以上作者的node-uuid的部分代码，源代码在 https://github.com/broofa/node-uuid，
//本文件代码经过原作者的源代码稍微修改而来
function uuid(){
	var  _rnds = new Array(16);
	var rnds = (function() {
		for (var i = 0, r; i < 16; i++) {
			if ((i & 0x03) === 0) r = Math.random() * 0x100000000;
			_rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;
		}
		return _rnds;
	})();
	rnds[6] = (rnds[6] & 0x0f) | 0x40;
	rnds[8] = (rnds[8] & 0x3f) | 0x80;
	var _byteToHex = [];
	for (var i = 0; i < 256; i++) {
		_byteToHex[i] = (i + 0x100).toString(16).substr(1);
	}
	var d = (function(buf) {
		var i = 0;
		var bth = _byteToHex;
		return  bth[buf[i++]] + bth[buf[i++]] +
				bth[buf[i++]] + bth[buf[i++]] + '-' +
				bth[buf[i++]] + bth[buf[i++]] + '-' +
				bth[buf[i++]] + bth[buf[i++]] + '-' +
				bth[buf[i++]] + bth[buf[i++]] + '-' +
				bth[buf[i++]] + bth[buf[i++]] +
				bth[buf[i++]] + bth[buf[i++]] +
				bth[buf[i++]] + bth[buf[i++]];
	})(rnds);
	return d;
}
exports.getUUID = uuid;