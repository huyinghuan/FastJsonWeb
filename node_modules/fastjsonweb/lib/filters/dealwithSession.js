var sessionData = require('../static_session');
var UUID = require("../uuid");
exports.deal = function(request,response,fn){
	if(request.headers.cookie && request.headers.cookie.indexOf("sid") === -1){ //生存session id
		request.headers.cookie =  request.headers.cookie+";sid="+UUID.getUUID();
	}
	if(!request.headers.cookie){
		request.headers.cookie = "sid="+UUID.getUUID();
	}
	var sid = request.headers.cookie.substr(request.headers.cookie.indexOf("sid")+4,36);
	var temp = sessionData.data[sid];
	if(temp){
		var nowtime = new Date().getTime();
		temp.time = nowtime;  //每次访问更新日期
		sessionData.data[sid] = temp;
	}
	fn(request,response);
}